!function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);class s{constructor(t,e){this.x=t,this.y=e}add(t){this.x+=t.x,this.y+=t.y}mult(t){this.x*=t,this.y*=t}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){let t=this.magnitude();this.x/=t,this.y/=t}zero(){this.x=0,this.y=0}distanceTo(t){return new s(t.x-this.x,t.y-this.y)}within(t,e){return this.x<=t.x+e&&this.x>=t.x-e&&this.y<=t.y+e&&this.y>=t.y-e}}class r{constructor(t,e,i,s){this.x=t-i/2,this.y=e-s/2,this.width=i,this.height=s,this.fill=!0}getRandomPosition(){let t,e;this.fill?(t=Math.random()*this.width,e=Math.random()*this.height):Math.random()<.5?(t=Math.random()*this.width,e=this.flipCoin()*this.height):(t=this.flipCoin()*this.width,e=Math.random()*this.height);let i=this.x+t,r=this.y+e;return new s(i,r)}flipCoin(){return Math.random()<.5?0:1}}class a{constructor(t,e,i){this.x=t,this.y=e,this.r=i,this.fill=!0}getRandomPosition(){let t=2*Math.PI*Math.random(),e=this.fill?this.r*Math.random():this.r,i=this.x+e*Math.cos(t),r=this.y+e*Math.sin(t);return new s(i,r)}}class o{set position(t){this.m_position.x=t.x,this.m_position.y=t.y}get position(){return this.m_position}set velocity(t){this.m_velocity.x=t.x,this.m_velocity.y=t.y}get velocity(){return this.m_velocity}set liveforever(t){this.m_liveforever=t}get isActive(){return this.m_active}addForce(t){t.mult(1/this.material.mass),this.m_acceleration.add(t)}constructor(t,e){this.material=e,this.m_position=new s(0,0),this.m_velocity=new s(0,0),this.m_acceleration=new s(0,0),this.liveforever=!1,this.m_lifetime=t,this.m_time_lived=0,this.m_active=!0}update(){this.m_velocity.add(this.m_acceleration),this.m_position.add(this.m_velocity),this.m_acceleration.zero(),this.m_time_lived>this.m_lifetime&&(this.m_active=!1),this.m_liveforever||this.m_time_lived++}}class n{constructor(t,e,i){this.ps_options=t,this.emitter=e,this.material=i,this.particles=new Array,this.forces=new Array,this.fields=new Array}addForce(t){this.forces.push(t)}addField(t){this.fields.push(t)}update(){this.addNewParticles(),this.updateParticleSystem()}draw(t){for(let e=0;e<this.particles.length;e++){let i=this.particles[e];t.beginPath(),t.fillStyle=this.material.color,t.arc(i.position.x,i.position.y,1,0,2*Math.PI),t.fill()}}updateParticleSystem(){for(let t=this.particles.length-1;t>=0;t--){let e=this.particles[t];this.applyForces(e),this.applyFields(e),e.update(),e.isActive||this.particles.splice(t,1)}}addNewParticles(){if(this.particles.length<this.ps_options.particles_max){let t=Math.floor(this.ps_options.particles_per_frame+this.rand()*this.ps_options.particles_per_frame_variance);for(let e=0;e<t;e++){let t=Math.floor(this.ps_options.particles_lifetime+this.rand()*this.ps_options.particles_lifetime_variance),e=new o(t,this.material);e.liveforever=this.ps_options.particles_liveforever,e.position=this.emitter.getRandomPosition(),this.particles.push(e)}}}applyForces(t){for(let e=0;e<this.forces.length;e++){let i=this.forces[e];t.addForce(i.getForce())}}applyFields(t){for(let e=0;e<this.fields.length;e++){let i=this.fields[e];i.updateParticle(t),i.active&&t.addForce(i.getForce())}}rand(){return 2*Math.random()-1}}class l{constructor(t,e,i){this.force=new s(t*i,e*i)}getForce(){return this.force}}let h,c,p,m,d=0;function f(){h.update(),c.update(),m.clearRect(0,0,500,250),h.draw(m),c.draw(m),++d%200==0&&console.log("frame:",d)}let _=new class{constructor(t){this.m_particle=null,this.m_target_position=new s(0,0),this.m_gain=t,this.active=!1}from(t){this.active=!0,this.m_target_position=t}updateParticle(t){this.m_particle=t}getForce(){if(!this.active)return new s(0,0);let t=this.m_particle.position.distanceTo(this.m_target_position),e=t.magnitude();return e=this.constrain(e,35,100),t.normalize(),t.mult(this.m_gain/(e*e)),t}constrain(t,e,i){return Math.max(e,Math.min(i,t))}}(500),u=new class{constructor(t){this.m_particle=null,this.m_target_position=new s(0,0),this.gain=t,this.active=!1}from(t){this.active=!0,this.m_target_position=t}updateParticle(t){this.m_particle=t}getForce(){if(!this.active)return new s(0,0);let t=this.m_particle.position.distanceTo(this.m_target_position),e=new s(t.x,t.y),i=t.magnitude();return e.normalize(),i<5&&(i=5),e.mult(-this.gain/(i*i)),e}}(25);function v(t){let e=t.clientX-p.offsetLeft,i=t.clientY-p.offsetTop,r=new s(e,i);u.from(r),_.from(r)}window.addEventListener("DOMContentLoaded",t=>{!function(){let t=new r(250,125,15,10),e={mass:1,color:"hsla(200, 75%, 50%, 0.8)",shape:"pixel"},i=new l(0,.2,e.mass);(h=new n({particles_max:600,particles_per_frame:12,particles_per_frame_variance:0,particles_liveforever:!1,particles_lifetime:50,particles_lifetime_variance:5},t,e)).addForce(i),h.addField(u)}(),function(){let t=new a(100,120,10),e={mass:1,color:"rgb(0, 0, 0)",shape:"pixel"};c=new n({particles_max:250,particles_per_frame:5,particles_per_frame_variance:0,particles_liveforever:!1,particles_lifetime:50,particles_lifetime_variance:0},t,e);let i=new l(0,.1,e.mass);c.addForce(i),c.addField(_)}(),p=document.querySelector("#stage"),m=p.getContext("2d"),p.addEventListener("mousemove",v),setInterval(f,1e3/45)})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWxzL3ZlY3Rvci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvZW1pdHRlci9yZWN0X2VtaXR0ZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2VtaXR0ZXIvY2lyY2xlX2VtaXR0ZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3BhcnRpY2xlLnRzIiwid2VicGFjazovLy8uL3NyYy9wYXJ0aWNsZV9zeXN0ZW0udHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2ZvcmNlL2dyYXZpdHkudHMiLCJ3ZWJwYWNrOi8vLy4vbWFpbi50cyIsIndlYnBhY2s6Ly8vLi9zcmMvZmllbGQvYXR0cmFjdC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvZmllbGQvcmVwZWwudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJWZWN0b3IiLCJbb2JqZWN0IE9iamVjdF0iLCJ4IiwieSIsInRoaXMiLCJvdGhlciIsInNjYWxhciIsIk1hdGgiLCJzcXJ0IiwibWFnbml0dWRlIiwicG9pbnQiLCJyYWRpdXMiLCJyZWN0X2VtaXR0ZXJfUmVjdEVtaXR0ZXIiLCJ3aWR0aCIsImhlaWdodCIsImZpbGwiLCJ3IiwiaCIsInJhbmRvbSIsImZsaXBDb2luIiwicngiLCJyeSIsImNpcmNsZV9lbWl0dGVyX0NpcmNsZUVtaXR0ZXIiLCJhbmdsZSIsIlBJIiwiY29zIiwic2luIiwicGFydGljbGVfUGFydGljbGUiLCJwb3NpdGlvbiIsIm1fcG9zaXRpb24iLCJ2ZWxvY2l0eSIsInYiLCJtX3ZlbG9jaXR5IiwibGl2ZWZvcmV2ZXIiLCJiIiwibV9saXZlZm9yZXZlciIsImlzQWN0aXZlIiwibV9hY3RpdmUiLCJmb3JjZSIsIm11bHQiLCJtYXRlcmlhbCIsIm1hc3MiLCJtX2FjY2VsZXJhdGlvbiIsImFkZCIsIm1fbGlmZXRpbWUiLCJtX3RpbWVfbGl2ZWQiLCJ6ZXJvIiwicGFydGljbGVfc3lzdGVtX1BhcnRpY2xlU3lzdGVtIiwicHNfb3B0aW9ucyIsImVtaXR0ZXIiLCJwYXJ0aWNsZXMiLCJBcnJheSIsImZvcmNlcyIsImZpZWxkcyIsInB1c2giLCJmaWVsZCIsImFkZE5ld1BhcnRpY2xlcyIsInVwZGF0ZVBhcnRpY2xlU3lzdGVtIiwiY3R4IiwibGVuZ3RoIiwiYmVnaW5QYXRoIiwiZmlsbFN0eWxlIiwiY29sb3IiLCJhcmMiLCJhcHBseUZvcmNlcyIsImFwcGx5RmllbGRzIiwidXBkYXRlIiwic3BsaWNlIiwicGFydGljbGVzX21heCIsImZsb29yIiwicGFydGljbGVzX3Blcl9mcmFtZSIsInJhbmQiLCJwYXJ0aWNsZXNfcGVyX2ZyYW1lX3ZhcmlhbmNlIiwibGlmZXRpbWUiLCJwYXJ0aWNsZXNfbGlmZXRpbWUiLCJwYXJ0aWNsZXNfbGlmZXRpbWVfdmFyaWFuY2UiLCJwYXJ0aWNsZSIsInBhcnRpY2xlc19saXZlZm9yZXZlciIsImdldFJhbmRvbVBvc2l0aW9uIiwiZiIsImFkZEZvcmNlIiwiZ2V0Rm9yY2UiLCJ1cGRhdGVQYXJ0aWNsZSIsImFjdGl2ZSIsImdyYXZpdHlfR3Jhdml0eSIsImFjY194IiwiYWNjX3kiLCJ3YXRlcl9wcyIsImRlYnJpc19wcyIsImNhbnZhcyIsImZyYW1lX2NvdW50ZXIiLCJhbmltYXRlIiwiY2xlYXJSZWN0IiwiZHJhdyIsImNvbnNvbGUiLCJsb2ciLCJhdHRyYWN0X2RlYnJpcyIsImdhaW4iLCJtX3BhcnRpY2xlIiwibV90YXJnZXRfcG9zaXRpb24iLCJtX2dhaW4iLCJ0YXJnZXRfcG9zaXRpb24iLCJkaXN0YW5jZVRvIiwiY29uc3RyYWluIiwibm9ybWFsaXplIiwibWluIiwibWF4IiwicmVwZWxfd2F0ZXIiLCJkaXN0YW5jZSIsIm9uTW91c2VNb3ZlIiwiZXZlbnQiLCJ4X21vdXNlIiwiY2xpZW50WCIsIm9mZnNldExlZnQiLCJ5X21vdXNlIiwiY2xpZW50WSIsIm9mZnNldFRvcCIsIm1vdXNlX3ZlYyIsImZyb20iLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwid2F0ZXJfZW1pdHRlciIsIndhdGVyX21hdCIsInNoYXBlIiwiZ3Jhdml0eSIsImFkZEZpZWxkIiwiaW5pdF93YXRlciIsImRlYnJpc19lbWl0dGVyIiwiZGVicmlzX21hdCIsImluaXRfZGVicmlzIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZ2V0Q29udGV4dCIsInNldEludGVydmFsIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxFQUFBLEdBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFDLFFBR0EsSUFBQUMsRUFBQUosRUFBQUUsR0FBQSxDQUNBRyxFQUFBSCxFQUNBSSxHQUFBLEVBQ0FILFFBQUEsSUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBS0FGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsRUFBQSxDQUEwQ0ssWUFBQSxFQUFBQyxJQUFBTCxLQUsxQ1osRUFBQWtCLEVBQUEsU0FBQWhCLEdBQ0Esb0JBQUFpQixlQUFBQyxhQUNBTixPQUFBQyxlQUFB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Qm1CLEdBM0JKLFdBQ0ksSUFBSUMsRUFBMEIsSUFBSXpHLEVBQWMsSUFBSyxJQUFLLElBRXREMEcsRUFBdUIsQ0FDdkJ2RixLQUFNLEVBQ05xQixNQUFPLGVBQ1A2RCxNQUFPLFNBWVhuQyxFQUFZLElBQUl6QyxFQVRhLENBQ3pCcUIsY0FBZSxJQUNmRSxvQkFBcUIsRUFDckJFLDZCQUE4QixFQUM5QkssdUJBQXVCLEVBQ3ZCSCxtQkFBb0IsR0FDcEJDLDRCQUE2QixHQUdXb0QsRUFBZ0JDLEdBRTVELElBQUlKLEVBQW1CLElBQUl4QyxFQUFRLEVBQUcsR0FBSzRDLEVBQVd2RixNQUV0RCtDLEVBQVVSLFNBQVM0QyxHQUNuQnBDLEVBQVVxQyxTQUFTN0IsR0FLbkJpQyxHQUVBeEMsRUFBU3lDLFNBQVNDLGNBQWMsVUFDaEN6RSxFQUFNK0IsRUFBTzJDLFdBQVcsTUFFeEIzQyxFQUFPK0IsaUJBQWlCLFlBQWFYLEdBRXJDd0IsWUFBWTFDLEVBQVMsSUFBTyIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJjbGFzcyBWZWN0b3Ige1xuXG4gICAgcHVibGljIHg6IG51bWJlcjtcbiAgICBwdWJsaWMgeTogbnVtYmVyO1xuXG4gICAgY29uc3RydWN0b3IoeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy54ID0geDtcbiAgICAgICAgdGhpcy55ID0geTtcbiAgICB9XG5cbiAgICBhZGQob3RoZXI6IFZlY3Rvcikge1xuICAgICAgICB0aGlzLnggKz0gb3RoZXIueDtcbiAgICAgICAgdGhpcy55ICs9IG90aGVyLnk7XG4gICAgfVxuXG4gICAgbXVsdChzY2FsYXI6IG51bWJlcikge1xuICAgICAgICB0aGlzLnggKj0gc2NhbGFyO1xuICAgICAgICB0aGlzLnkgKj0gc2NhbGFyO1xuICAgIH1cblxuICAgIG1hZ25pdHVkZSgpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KHRoaXMueCAqIHRoaXMueCArIHRoaXMueSAqIHRoaXMueSk7XG4gICAgfVxuXG4gICAgbm9ybWFsaXplKCkge1xuICAgICAgICBsZXQgZDogbnVtYmVyID0gdGhpcy5tYWduaXR1ZGUoKTtcbiAgICAgICAgdGhpcy54IC89IGQ7XG4gICAgICAgIHRoaXMueSAvPSBkO1xuICAgIH1cblxuICAgIHplcm8oKSB7XG4gICAgICAgIHRoaXMueCA9IDA7XG4gICAgICAgIHRoaXMueSA9IDA7XG4gICAgfVxuXG4gICAgZGlzdGFuY2VUbyhvdGhlcjogVmVjdG9yKTogVmVjdG9yIHtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3Iob3RoZXIueCAtIHRoaXMueCwgb3RoZXIueSAtIHRoaXMueSk7XG4gICAgfVxuXG4gICAgd2l0aGluKHBvaW50OiBWZWN0b3IsIHJhZGl1czogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICB0aGlzLnggPD0gcG9pbnQueCArIHJhZGl1cyAmJlxuICAgICAgICAgICAgdGhpcy54ID49IHBvaW50LnggLSByYWRpdXMgJiZcbiAgICAgICAgICAgIHRoaXMueSA8PSBwb2ludC55ICsgcmFkaXVzICYmXG4gICAgICAgICAgICB0aGlzLnkgPj0gcG9pbnQueSAtIHJhZGl1c1xuICAgICAgICApO1xuICAgIH1cblxufVxuXG5leHBvcnQgeyBWZWN0b3IgfTsiLCJpbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSBcIi4vZW1pdHRlclwiO1xuaW1wb3J0IHsgVmVjdG9yIH0gZnJvbSBcIi4uL3V0aWxzL3ZlY3RvclwiO1xuXG5jbGFzcyBSZWN0RW1pdHRlciBpbXBsZW1lbnRzIEVtaXR0ZXIge1xuICAgIHByaXZhdGUgeDogbnVtYmVyO1xuICAgIHByaXZhdGUgeTogbnVtYmVyO1xuICAgIHByaXZhdGUgd2lkdGg6IG51bWJlcjtcbiAgICBwcml2YXRlIGhlaWdodDogbnVtYmVyO1xuICAgIHB1YmxpYyBmaWxsOiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3IoeDogbnVtYmVyLCB5OiBudW1iZXIsIHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMueCA9IHggLSB3aWR0aCAvIDI7XG4gICAgICAgIHRoaXMueSA9IHkgLSBoZWlnaHQgLyAyO1xuICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICB0aGlzLmZpbGwgPSB0cnVlO1xuICAgIH1cblxuICAgIGdldFJhbmRvbVBvc2l0aW9uKCk6IFZlY3RvciB7XG4gICAgICAgIGxldCB3OiBudW1iZXI7XG4gICAgICAgIGxldCBoOiBudW1iZXI7XG5cbiAgICAgICAgaWYgKHRoaXMuZmlsbCkge1xuICAgICAgICAgICAgdyA9IE1hdGgucmFuZG9tKCkgKiB0aGlzLndpZHRoO1xuICAgICAgICAgICAgaCA9IE1hdGgucmFuZG9tKCkgKiB0aGlzLmhlaWdodDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgMC41KSB7XG4gICAgICAgICAgICAgICAgdyA9IE1hdGgucmFuZG9tKCkgKiB0aGlzLndpZHRoO1xuICAgICAgICAgICAgICAgIGggPSB0aGlzLmZsaXBDb2luKCkgKiB0aGlzLmhlaWdodDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdyA9IHRoaXMuZmxpcENvaW4oKSAqIHRoaXMud2lkdGg7XG4gICAgICAgICAgICAgICAgaCA9IE1hdGgucmFuZG9tKCkgKiB0aGlzLmhlaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGxldCByeDogbnVtYmVyID0gdGhpcy54ICsgdztcbiAgICAgICAgbGV0IHJ5OiBudW1iZXIgPSB0aGlzLnkgKyBoO1xuICAgICAgICBsZXQgcG9zOiBWZWN0b3IgPSBuZXcgVmVjdG9yKHJ4LCByeSk7XG5cbiAgICAgICAgcmV0dXJuIHBvcztcbiAgICB9XG5cbiAgICAvLyByZXR1cm4gMCB8IDFcbiAgICBwcml2YXRlIGZsaXBDb2luKCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiBNYXRoLnJhbmRvbSgpIDwgMC41ID8gMCA6IDE7XG4gICAgfVxufVxuXG5leHBvcnQgeyBSZWN0RW1pdHRlciB9O1xuIiwiaW1wb3J0IHsgRW1pdHRlciB9IGZyb20gXCIuL2VtaXR0ZXJcIjtcbmltcG9ydCB7IFZlY3RvciB9IGZyb20gXCIuLi91dGlscy92ZWN0b3JcIjtcblxuY2xhc3MgQ2lyY2xlRW1pdHRlciBpbXBsZW1lbnRzIEVtaXR0ZXIge1xuICAgIHByaXZhdGUgeDogbnVtYmVyO1xuICAgIHByaXZhdGUgeTogbnVtYmVyO1xuICAgIHByaXZhdGUgcjogbnVtYmVyO1xuICAgIHB1YmxpYyBmaWxsOiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3IoeDogbnVtYmVyLCB5OiBudW1iZXIsIHJhZGl1czogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMueCA9IHg7XG4gICAgICAgIHRoaXMueSA9IHk7XG4gICAgICAgIHRoaXMuciA9IHJhZGl1cztcbiAgICAgICAgdGhpcy5maWxsID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBnZXRSYW5kb21Qb3NpdGlvbigpOiBWZWN0b3Ige1xuICAgICAgICBsZXQgYW5nbGU6IG51bWJlciA9IDIgKiBNYXRoLlBJICogTWF0aC5yYW5kb20oKTtcbiAgICAgICAgbGV0IHJhZGl1czogbnVtYmVyID0gdGhpcy5maWxsID8gdGhpcy5yICogTWF0aC5yYW5kb20oKSA6IHRoaXMucjtcbiAgICAgICAgbGV0IHJ4OiBudW1iZXIgPSB0aGlzLnggKyByYWRpdXMgKiBNYXRoLmNvcyhhbmdsZSk7XG4gICAgICAgIGxldCByeTogbnVtYmVyID0gdGhpcy55ICsgcmFkaXVzICogTWF0aC5zaW4oYW5nbGUpO1xuICAgICAgICBsZXQgcG9zOiBWZWN0b3IgPSBuZXcgVmVjdG9yKHJ4LCByeSk7XG4gICAgICAgIHJldHVybiBwb3M7XG4gICAgfVxufVxuXG5leHBvcnQgeyBDaXJjbGVFbWl0dGVyIH07XG4iLCJpbXBvcnQgeyBWZWN0b3IgfSBmcm9tIFwiLi91dGlscy92ZWN0b3JcIjtcbmltcG9ydCB7IE1hdGVyaWFsIH0gZnJvbSBcIi4vbWF0ZXJpYWxcIjtcblxuY2xhc3MgUGFydGljbGUge1xuICAgIHByaXZhdGUgbWF0ZXJpYWw6IE1hdGVyaWFsO1xuICAgIHByaXZhdGUgbV9wb3NpdGlvbjogVmVjdG9yO1xuICAgIHByaXZhdGUgbV92ZWxvY2l0eTogVmVjdG9yO1xuICAgIHByaXZhdGUgbV9hY2NlbGVyYXRpb246IFZlY3RvcjtcbiAgICBwcml2YXRlIG1fbGl2ZWZvcmV2ZXI6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSBtX2xpZmV0aW1lOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBtX3RpbWVfbGl2ZWQ6IG51bWJlcjtcbiAgICBwcml2YXRlIG1fYWN0aXZlOiBib29sZWFuO1xuXG4gICAgc2V0IHBvc2l0aW9uKHBvaW50OiBWZWN0b3IpIHtcbiAgICAgICAgdGhpcy5tX3Bvc2l0aW9uLnggPSBwb2ludC54O1xuICAgICAgICB0aGlzLm1fcG9zaXRpb24ueSA9IHBvaW50Lnk7XG4gICAgfVxuXG4gICAgZ2V0IHBvc2l0aW9uKCk6IFZlY3RvciB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fcG9zaXRpb247XG4gICAgfVxuXG4gICAgc2V0IHZlbG9jaXR5KHY6IFZlY3Rvcikge1xuICAgICAgICB0aGlzLm1fdmVsb2NpdHkueCA9IHYueDtcbiAgICAgICAgdGhpcy5tX3ZlbG9jaXR5LnkgPSB2Lnk7XG4gICAgfVxuXG4gICAgZ2V0IHZlbG9jaXR5KCk6IFZlY3RvciB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fdmVsb2NpdHk7XG4gICAgfVxuXG4gICAgc2V0IGxpdmVmb3JldmVyKGI6IGJvb2xlYW4pIHtcbiAgICAgICAgdGhpcy5tX2xpdmVmb3JldmVyID0gYjtcbiAgICB9XG5cbiAgICBnZXQgaXNBY3RpdmUoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLm1fYWN0aXZlO1xuICAgIH1cblxuICAgIGFkZEZvcmNlKGZvcmNlOiBWZWN0b3IpIHtcbiAgICAgICAgZm9yY2UubXVsdCgxIC8gdGhpcy5tYXRlcmlhbC5tYXNzKTtcbiAgICAgICAgdGhpcy5tX2FjY2VsZXJhdGlvbi5hZGQoZm9yY2UpO1xuICAgIH1cblxuICAgIGNvbnN0cnVjdG9yKG1fbGlmZXRpbWU6IG51bWJlciwgbWF0ZXJpYWw6IE1hdGVyaWFsKSB7XG4gICAgICAgIHRoaXMubWF0ZXJpYWwgPSBtYXRlcmlhbDtcbiAgICAgICAgdGhpcy5tX3Bvc2l0aW9uID0gbmV3IFZlY3RvcigwLCAwKTtcbiAgICAgICAgdGhpcy5tX3ZlbG9jaXR5ID0gbmV3IFZlY3RvcigwLCAwKTtcbiAgICAgICAgdGhpcy5tX2FjY2VsZXJhdGlvbiA9IG5ldyBWZWN0b3IoMCwgMCk7XG4gICAgICAgIHRoaXMubGl2ZWZvcmV2ZXIgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX2xpZmV0aW1lID0gbV9saWZldGltZTtcbiAgICAgICAgdGhpcy5tX3RpbWVfbGl2ZWQgPSAwO1xuICAgICAgICB0aGlzLm1fYWN0aXZlID0gdHJ1ZTtcbiAgICB9XG5cbiAgICB1cGRhdGUoKSB7XG4gICAgICAgIHRoaXMubV92ZWxvY2l0eS5hZGQodGhpcy5tX2FjY2VsZXJhdGlvbik7XG4gICAgICAgIHRoaXMubV9wb3NpdGlvbi5hZGQodGhpcy5tX3ZlbG9jaXR5KTtcbiAgICAgICAgdGhpcy5tX2FjY2VsZXJhdGlvbi56ZXJvKCk7XG5cbiAgICAgICAgaWYgKHRoaXMubV90aW1lX2xpdmVkID4gdGhpcy5tX2xpZmV0aW1lKSB7XG4gICAgICAgICAgICB0aGlzLm1fYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRoaXMubV9saXZlZm9yZXZlcikge1xuICAgICAgICAgICAgdGhpcy5tX3RpbWVfbGl2ZWQrKztcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IHsgUGFydGljbGUgfTtcbiIsImltcG9ydCB7IFBhcnRpY2xlIH0gZnJvbSBcIi4vcGFydGljbGVcIjtcbmltcG9ydCB7IE1hdGVyaWFsIH0gZnJvbSBcIi4vbWF0ZXJpYWxcIjtcbmltcG9ydCB7IHBzT3B0aW9ucyB9IGZyb20gXCIuL3BzX29wdGlvbnNcIjtcbmltcG9ydCB7IEVtaXR0ZXIgfSBmcm9tIFwiLi9lbWl0dGVyL2VtaXR0ZXJcIjtcbmltcG9ydCB7IEZpZWxkIH0gZnJvbSBcIi4vZmllbGQvZmllbGRcIjtcbmltcG9ydCB7IEZvcmNlIH0gZnJvbSBcIi4vZm9yY2UvZm9yY2VcIjtcblxuY2xhc3MgUGFydGljbGVTeXN0ZW0ge1xuICAgIHByaXZhdGUgcGFydGljbGVzOiBQYXJ0aWNsZVtdO1xuICAgIHByaXZhdGUgZm9yY2VzOiBGb3JjZVtdO1xuICAgIHByaXZhdGUgZmllbGRzOiBGaWVsZFtdO1xuICAgIHByaXZhdGUgbWF0ZXJpYWw6IE1hdGVyaWFsO1xuICAgIHByaXZhdGUgcHNfb3B0aW9uczogcHNPcHRpb25zO1xuICAgIHByaXZhdGUgZW1pdHRlcjogRW1pdHRlcjtcblxuICAgIGNvbnN0cnVjdG9yKHBzX29wdGlvbnM6IHBzT3B0aW9ucywgZW1pdHRlcjogRW1pdHRlciwgbWF0ZXJpYWw6IE1hdGVyaWFsKSB7XG4gICAgICAgIHRoaXMucHNfb3B0aW9ucyA9IHBzX29wdGlvbnM7XG4gICAgICAgIHRoaXMuZW1pdHRlciA9IGVtaXR0ZXI7XG4gICAgICAgIHRoaXMubWF0ZXJpYWwgPSBtYXRlcmlhbDtcbiAgICAgICAgdGhpcy5wYXJ0aWNsZXMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgdGhpcy5mb3JjZXMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgdGhpcy5maWVsZHMgPSBuZXcgQXJyYXkoKTtcbiAgICB9XG5cbiAgICBhZGRGb3JjZShmb3JjZTogRm9yY2UpIHtcbiAgICAgICAgdGhpcy5mb3JjZXMucHVzaChmb3JjZSk7XG4gICAgfVxuXG4gICAgYWRkRmllbGQoZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHRoaXMuZmllbGRzLnB1c2goZmllbGQpO1xuICAgIH1cblxuICAgIHVwZGF0ZSgpIHtcbiAgICAgICAgdGhpcy5hZGROZXdQYXJ0aWNsZXMoKTtcbiAgICAgICAgdGhpcy51cGRhdGVQYXJ0aWNsZVN5c3RlbSgpO1xuICAgIH1cblxuICAgIGRyYXcoY3R4OiBhbnkpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnBhcnRpY2xlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbGV0IHA6IFBhcnRpY2xlID0gdGhpcy5wYXJ0aWNsZXNbaV07XG4gICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gdGhpcy5tYXRlcmlhbC5jb2xvcjtcbiAgICAgICAgICAgIGN0eC5hcmMocC5wb3NpdGlvbi54LCBwLnBvc2l0aW9uLnksIDEsIDAsIDIgKiBNYXRoLlBJKTtcbiAgICAgICAgICAgIGN0eC5maWxsKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHVwZGF0ZVBhcnRpY2xlU3lzdGVtKCkge1xuICAgICAgICBmb3IgKGxldCBpID0gdGhpcy5wYXJ0aWNsZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGxldCBwOiBQYXJ0aWNsZSA9IHRoaXMucGFydGljbGVzW2ldO1xuICAgICAgICAgICAgdGhpcy5hcHBseUZvcmNlcyhwKTtcbiAgICAgICAgICAgIHRoaXMuYXBwbHlGaWVsZHMocCk7XG4gICAgICAgICAgICBwLnVwZGF0ZSgpO1xuICAgICAgICAgICAgaWYgKCFwLmlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJ0aWNsZXMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhZGROZXdQYXJ0aWNsZXMoKSB7XG4gICAgICAgIGlmICh0aGlzLnBhcnRpY2xlcy5sZW5ndGggPCB0aGlzLnBzX29wdGlvbnMucGFydGljbGVzX21heCkge1xuICAgICAgICAgICAgbGV0IG46IG51bWJlciA9IE1hdGguZmxvb3IoXG4gICAgICAgICAgICAgICAgdGhpcy5wc19vcHRpb25zLnBhcnRpY2xlc19wZXJfZnJhbWUgK1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJhbmQoKSAqIHRoaXMucHNfb3B0aW9ucy5wYXJ0aWNsZXNfcGVyX2ZyYW1lX3ZhcmlhbmNlXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgICAgICAgICBsZXQgbGlmZXRpbWU6IG51bWJlciA9IE1hdGguZmxvb3IoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHNfb3B0aW9ucy5wYXJ0aWNsZXNfbGlmZXRpbWUgK1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yYW5kKCkgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHNfb3B0aW9ucy5wYXJ0aWNsZXNfbGlmZXRpbWVfdmFyaWFuY2VcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGxldCBwYXJ0aWNsZSA9IG5ldyBQYXJ0aWNsZShsaWZldGltZSwgdGhpcy5tYXRlcmlhbCk7XG4gICAgICAgICAgICAgICAgcGFydGljbGUubGl2ZWZvcmV2ZXIgPSB0aGlzLnBzX29wdGlvbnMucGFydGljbGVzX2xpdmVmb3JldmVyO1xuICAgICAgICAgICAgICAgIHBhcnRpY2xlLnBvc2l0aW9uID0gdGhpcy5lbWl0dGVyLmdldFJhbmRvbVBvc2l0aW9uKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJ0aWNsZXMucHVzaChwYXJ0aWNsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGFwcGx5Rm9yY2VzKHA6IFBhcnRpY2xlKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5mb3JjZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGxldCBmOiBGb3JjZSA9IHRoaXMuZm9yY2VzW2ldO1xuICAgICAgICAgICAgcC5hZGRGb3JjZShmLmdldEZvcmNlKCkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhcHBseUZpZWxkcyhwOiBQYXJ0aWNsZSkge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZmllbGRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgZmllbGQ6IEZpZWxkID0gdGhpcy5maWVsZHNbaV07XG4gICAgICAgICAgICBmaWVsZC51cGRhdGVQYXJ0aWNsZShwKTtcbiAgICAgICAgICAgIGlmIChmaWVsZC5hY3RpdmUpIHtcbiAgICAgICAgICAgICAgICBwLmFkZEZvcmNlKGZpZWxkLmdldEZvcmNlKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gcmV0dXJucyBbLTEsIDFdXG4gICAgcHJpdmF0ZSByYW5kKCkge1xuICAgICAgICByZXR1cm4gTWF0aC5yYW5kb20oKSAqIDIgLSAxO1xuICAgIH1cbn1cblxuZXhwb3J0IHsgUGFydGljbGVTeXN0ZW0gfTtcbiIsImltcG9ydCB7IEZvcmNlIH0gZnJvbSBcIi4vZm9yY2VcIjtcbmltcG9ydCB7IFZlY3RvciB9IGZyb20gXCIuLi91dGlscy92ZWN0b3JcIjtcblxuY2xhc3MgR3Jhdml0eSBpbXBsZW1lbnRzIEZvcmNlIHtcbiAgICBwcml2YXRlIGZvcmNlOiBWZWN0b3I7XG5cbiAgICBjb25zdHJ1Y3RvcihhY2NfeDogbnVtYmVyLCBhY2NfeTogbnVtYmVyLCBtYXNzOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5mb3JjZSA9IG5ldyBWZWN0b3IoYWNjX3ggKiBtYXNzLCBhY2NfeSAqIG1hc3MpO1xuICAgIH1cblxuICAgIGdldEZvcmNlKCk6IFZlY3RvciB7XG4gICAgICAgIHJldHVybiB0aGlzLmZvcmNlO1xuICAgIH1cbn1cblxuZXhwb3J0IHsgR3Jhdml0eSB9O1xuIiwiaW1wb3J0IHsgTWF0ZXJpYWwgfSBmcm9tIFwiLi9zcmMvbWF0ZXJpYWxcIjtcbmltcG9ydCB7IHBzT3B0aW9ucyB9IGZyb20gXCIuL3NyYy9wc19vcHRpb25zXCI7XG5pbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSBcIi4vc3JjL2VtaXR0ZXIvZW1pdHRlclwiO1xuaW1wb3J0IHsgUmVjdEVtaXR0ZXIgfSBmcm9tIFwiLi9zcmMvZW1pdHRlci9yZWN0X2VtaXR0ZXJcIjtcbmltcG9ydCB7IENpcmNsZUVtaXR0ZXIgfSBmcm9tIFwiLi9zcmMvZW1pdHRlci9jaXJjbGVfZW1pdHRlclwiO1xuaW1wb3J0IHsgUGFydGljbGVTeXN0ZW0gfSBmcm9tIFwiLi9zcmMvcGFydGljbGVfc3lzdGVtXCI7XG5pbXBvcnQgeyBHcmF2aXR5IH0gZnJvbSBcIi4vc3JjL2ZvcmNlL2dyYXZpdHlcIjtcbmltcG9ydCB7IFZlY3RvciB9IGZyb20gXCIuL3NyYy91dGlscy92ZWN0b3JcIjtcbmltcG9ydCB7IFJlcGVsIH0gZnJvbSBcIi4vc3JjL2ZpZWxkL3JlcGVsXCI7XG5pbXBvcnQgeyBBdHRyYWN0IH0gZnJvbSBcIi4vc3JjL2ZpZWxkL2F0dHJhY3RcIjtcblxubGV0IHdhdGVyX3BzOiBQYXJ0aWNsZVN5c3RlbTtcbmxldCBkZWJyaXNfcHM6IFBhcnRpY2xlU3lzdGVtO1xuXG5sZXQgY2FudmFzOiBhbnk7XG5sZXQgY3R4OiBhbnk7XG5sZXQgZnJhbWVfY291bnRlcjogbnVtYmVyID0gMDtcblxuZnVuY3Rpb24gYW5pbWF0ZSgpIHtcbiAgICB3YXRlcl9wcy51cGRhdGUoKTtcbiAgICBkZWJyaXNfcHMudXBkYXRlKCk7XG5cbiAgICBjdHguY2xlYXJSZWN0KDAsIDAsIDUwMCwgMjUwKTtcbiAgICB3YXRlcl9wcy5kcmF3KGN0eCk7XG4gICAgZGVicmlzX3BzLmRyYXcoY3R4KTtcblxuICAgIGZyYW1lX2NvdW50ZXIrKztcbiAgICBpZiAoZnJhbWVfY291bnRlciAlIDIwMCA9PSAwKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZnJhbWU6XCIsIGZyYW1lX2NvdW50ZXIpO1xuICAgIH1cbn1cblxubGV0IGF0dHJhY3RfZGVicmlzOiBBdHRyYWN0ID0gbmV3IEF0dHJhY3QoNTAwKTtcbmxldCByZXBlbF93YXRlcjogUmVwZWwgPSBuZXcgUmVwZWwoMjUpO1xuXG5mdW5jdGlvbiBvbk1vdXNlTW92ZShldmVudDogYW55KSB7XG4gICAgbGV0IHhfbW91c2U6IG51bWJlciA9IGV2ZW50LmNsaWVudFggLSBjYW52YXMub2Zmc2V0TGVmdDtcbiAgICBsZXQgeV9tb3VzZTogbnVtYmVyID0gZXZlbnQuY2xpZW50WSAtIGNhbnZhcy5vZmZzZXRUb3A7XG4gICAgbGV0IG1vdXNlX3ZlYzogVmVjdG9yID0gbmV3IFZlY3Rvcih4X21vdXNlLCB5X21vdXNlKTtcbiAgICByZXBlbF93YXRlci5mcm9tKG1vdXNlX3ZlYyk7XG4gICAgYXR0cmFjdF9kZWJyaXMuZnJvbShtb3VzZV92ZWMpO1xufVxuXG5mdW5jdGlvbiBpbml0X3dhdGVyKCkge1xuICAgIGxldCB3YXRlcl9lbWl0dGVyOiBFbWl0dGVyID0gbmV3IFJlY3RFbWl0dGVyKDI1MCwgMTI1LCAxNSwgMTApO1xuXG4gICAgbGV0IHdhdGVyX21hdDogTWF0ZXJpYWwgPSB7XG4gICAgICAgIG1hc3M6IDEsXG4gICAgICAgIGNvbG9yOiBcImhzbGEoMjAwLCA3NSUsIDUwJSwgMC44KVwiLFxuICAgICAgICBzaGFwZTogXCJwaXhlbFwiXG4gICAgfTtcblxuICAgIGxldCB3YXRlcl9vcHRzOiBwc09wdGlvbnMgPSB7XG4gICAgICAgIHBhcnRpY2xlc19tYXg6IDYwMCxcbiAgICAgICAgcGFydGljbGVzX3Blcl9mcmFtZTogMTIsXG4gICAgICAgIHBhcnRpY2xlc19wZXJfZnJhbWVfdmFyaWFuY2U6IDAsXG4gICAgICAgIHBhcnRpY2xlc19saXZlZm9yZXZlcjogZmFsc2UsXG4gICAgICAgIHBhcnRpY2xlc19saWZldGltZTogNTAsXG4gICAgICAgIHBhcnRpY2xlc19saWZldGltZV92YXJpYW5jZTogNVxuICAgIH07XG5cbiAgICBsZXQgZ3Jhdml0eTogR3Jhdml0eSA9IG5ldyBHcmF2aXR5KDAsIDAuMiwgd2F0ZXJfbWF0Lm1hc3MpO1xuXG4gICAgd2F0ZXJfcHMgPSBuZXcgUGFydGljbGVTeXN0ZW0od2F0ZXJfb3B0cywgd2F0ZXJfZW1pdHRlciwgd2F0ZXJfbWF0KTtcbiAgICB3YXRlcl9wcy5hZGRGb3JjZShncmF2aXR5KTtcbiAgICB3YXRlcl9wcy5hZGRGaWVsZChyZXBlbF93YXRlcik7XG59XG5mdW5jdGlvbiBpbml0X2RlYnJpcygpIHtcbiAgICBsZXQgZGVicmlzX2VtaXR0ZXI6IEVtaXR0ZXIgPSBuZXcgQ2lyY2xlRW1pdHRlcigxMDAsIDEyMCwgMTApO1xuXG4gICAgbGV0IGRlYnJpc19tYXQ6IE1hdGVyaWFsID0ge1xuICAgICAgICBtYXNzOiAxLFxuICAgICAgICBjb2xvcjogXCJyZ2IoMCwgMCwgMClcIixcbiAgICAgICAgc2hhcGU6IFwicGl4ZWxcIlxuICAgIH07XG5cbiAgICBsZXQgZGVicmlzX29wdHM6IHBzT3B0aW9ucyA9IHtcbiAgICAgICAgcGFydGljbGVzX21heDogMjUwLFxuICAgICAgICBwYXJ0aWNsZXNfcGVyX2ZyYW1lOiA1LFxuICAgICAgICBwYXJ0aWNsZXNfcGVyX2ZyYW1lX3ZhcmlhbmNlOiAwLFxuICAgICAgICBwYXJ0aWNsZXNfbGl2ZWZvcmV2ZXI6IGZhbHNlLFxuICAgICAgICBwYXJ0aWNsZXNfbGlmZXRpbWU6IDUwLFxuICAgICAgICBwYXJ0aWNsZXNfbGlmZXRpbWVfdmFyaWFuY2U6IDBcbiAgICB9O1xuXG4gICAgZGVicmlzX3BzID0gbmV3IFBhcnRpY2xlU3lzdGVtKGRlYnJpc19vcHRzLCBkZWJyaXNfZW1pdHRlciwgZGVicmlzX21hdCk7XG5cbiAgICBsZXQgZ3Jhdml0eTogR3Jhdml0eSA9IG5ldyBHcmF2aXR5KDAsIDAuMSwgZGVicmlzX21hdC5tYXNzKTtcblxuICAgIGRlYnJpc19wcy5hZGRGb3JjZShncmF2aXR5KTtcbiAgICBkZWJyaXNfcHMuYWRkRmllbGQoYXR0cmFjdF9kZWJyaXMpO1xufVxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZXZlbnQgPT4ge1xuICAgIGluaXRfd2F0ZXIoKTtcbiAgICBpbml0X2RlYnJpcygpO1xuXG4gICAgY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNzdGFnZVwiKTtcbiAgICBjdHggPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xuXG4gICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgb25Nb3VzZU1vdmUpO1xuXG4gICAgc2V0SW50ZXJ2YWwoYW5pbWF0ZSwgMTAwMCAvIDQ1KTtcbn0pO1xuIiwiaW1wb3J0IHsgRmllbGQgfSBmcm9tIFwiLi9maWVsZFwiO1xuaW1wb3J0IHsgVmVjdG9yIH0gZnJvbSBcIi4uL3V0aWxzL3ZlY3RvclwiO1xuaW1wb3J0IHsgUGFydGljbGUgfSBmcm9tIFwiLi4vcGFydGljbGVcIjtcblxuY2xhc3MgQXR0cmFjdCBpbXBsZW1lbnRzIEZpZWxkIHtcbiAgICBwdWJsaWMgYWN0aXZlOiBib29sZWFuO1xuICAgIHByaXZhdGUgbV9wYXJ0aWNsZTogUGFydGljbGU7XG4gICAgcHJpdmF0ZSBtX3RhcmdldF9wb3NpdGlvbjogVmVjdG9yO1xuICAgIHByaXZhdGUgbV9nYWluOiBudW1iZXI7XG5cbiAgICBjb25zdHJ1Y3RvcihnYWluOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5tX3BhcnRpY2xlID0gbnVsbDtcbiAgICAgICAgdGhpcy5tX3RhcmdldF9wb3NpdGlvbiA9IG5ldyBWZWN0b3IoMCwgMCk7XG4gICAgICAgIHRoaXMubV9nYWluID0gZ2FpbjtcbiAgICAgICAgdGhpcy5hY3RpdmUgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBmcm9tKHRhcmdldF9wb3NpdGlvbjogVmVjdG9yKSB7XG4gICAgICAgIHRoaXMuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5tX3RhcmdldF9wb3NpdGlvbiA9IHRhcmdldF9wb3NpdGlvbjtcbiAgICB9XG5cbiAgICB1cGRhdGVQYXJ0aWNsZShwOiBQYXJ0aWNsZSkge1xuICAgICAgICB0aGlzLm1fcGFydGljbGUgPSBwO1xuICAgIH1cblxuICAgIGdldEZvcmNlKCk6IFZlY3RvciB7XG4gICAgICAgIGlmICghdGhpcy5hY3RpdmUpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgVmVjdG9yKDAsIDApO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGZvcmNlOiBWZWN0b3IgPSB0aGlzLm1fcGFydGljbGUucG9zaXRpb24uZGlzdGFuY2VUbyhcbiAgICAgICAgICAgIHRoaXMubV90YXJnZXRfcG9zaXRpb25cbiAgICAgICAgKTtcbiAgICAgICAgbGV0IGQ6IG51bWJlciA9IGZvcmNlLm1hZ25pdHVkZSgpO1xuICAgICAgICBkID0gdGhpcy5jb25zdHJhaW4oZCwgMzUsIDEwMCk7XG4gICAgICAgIGZvcmNlLm5vcm1hbGl6ZSgpO1xuICAgICAgICBmb3JjZS5tdWx0KHRoaXMubV9nYWluIC8gKGQgKiBkKSk7XG4gICAgICAgIHJldHVybiBmb3JjZTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNvbnN0cmFpbih2YWx1ZTogbnVtYmVyLCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gTWF0aC5tYXgobWluLCBNYXRoLm1pbihtYXgsIHZhbHVlKSk7XG4gICAgfVxufVxuXG5leHBvcnQgeyBBdHRyYWN0IH07XG4iLCJpbXBvcnQgeyBGaWVsZCB9IGZyb20gXCIuL2ZpZWxkXCI7XG5pbXBvcnQgeyBWZWN0b3IgfSBmcm9tIFwiLi4vdXRpbHMvdmVjdG9yXCI7XG5pbXBvcnQgeyBQYXJ0aWNsZSB9IGZyb20gXCIuLi9wYXJ0aWNsZVwiO1xuXG5jbGFzcyBSZXBlbCBpbXBsZW1lbnRzIEZpZWxkIHtcbiAgICBwdWJsaWMgYWN0aXZlOiBib29sZWFuO1xuICAgIHByaXZhdGUgbV9wYXJ0aWNsZTogUGFydGljbGU7XG4gICAgcHJpdmF0ZSBtX3RhcmdldF9wb3NpdGlvbjogVmVjdG9yO1xuICAgIHByaXZhdGUgZ2FpbjogbnVtYmVyO1xuXG4gICAgY29uc3RydWN0b3IoZ2FpbjogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMubV9wYXJ0aWNsZSA9IG51bGw7XG4gICAgICAgIHRoaXMubV90YXJnZXRfcG9zaXRpb24gPSBuZXcgVmVjdG9yKDAsIDApO1xuICAgICAgICB0aGlzLmdhaW4gPSBnYWluO1xuICAgICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH1cblxuICAgIGZyb20obV90YXJnZXRfcG9zaXRpb246IFZlY3Rvcikge1xuICAgICAgICB0aGlzLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMubV90YXJnZXRfcG9zaXRpb24gPSBtX3RhcmdldF9wb3NpdGlvbjtcbiAgICB9XG5cbiAgICB1cGRhdGVQYXJ0aWNsZShwOiBQYXJ0aWNsZSkge1xuICAgICAgICB0aGlzLm1fcGFydGljbGUgPSBwO1xuICAgIH1cblxuICAgIGdldEZvcmNlKCk6IFZlY3RvciB7XG4gICAgICAgIGlmICghdGhpcy5hY3RpdmUpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgVmVjdG9yKDAsIDApO1xuICAgICAgICB9XG4gICAgICAgIGxldCBkaXN0YW5jZTogVmVjdG9yID0gdGhpcy5tX3BhcnRpY2xlLnBvc2l0aW9uLmRpc3RhbmNlVG8oXG4gICAgICAgICAgICB0aGlzLm1fdGFyZ2V0X3Bvc2l0aW9uXG4gICAgICAgICk7XG4gICAgICAgIGxldCBmOiBWZWN0b3IgPSBuZXcgVmVjdG9yKGRpc3RhbmNlLngsIGRpc3RhbmNlLnkpO1xuICAgICAgICBsZXQgZDogbnVtYmVyID0gZGlzdGFuY2UubWFnbml0dWRlKCk7XG4gICAgICAgIGYubm9ybWFsaXplKCk7XG4gICAgICAgIGlmIChkIDwgNSkgZCA9IDU7XG4gICAgICAgIGYubXVsdCgtdGhpcy5nYWluIC8gKGQgKiBkKSk7XG4gICAgICAgIHJldHVybiBmO1xuICAgIH1cbn1cblxuZXhwb3J0IHsgUmVwZWwgfTtcbiJdLCJzb3VyY2VSb290IjoiIn0=